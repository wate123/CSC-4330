<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>MODEL &mdash; Technician Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Free HTML5 Website Template by FreeHTML5.co" />
    <meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
    <meta name="author" content="FreeHTML5.co" />
    <!--
   //////////////////////////////////////////////////////

   FREE HTML5 TEMPLATE
   DESIGNED & DEVELOPED by FREEHTML5.CO

   Website: 		http://freehtml5.co/
   Email: 			info@freehtml5.co
   Twitter: 		http://twitter.com/fh5co
   Facebook: 		https://www.facebook.com/fh5co

   //////////////////////////////////////////////////////
    -->

    <!-- Facebook and Twitter integration -->
    <meta property="og:title" content=""/>
    <meta property="og:image" content=""/>
    <meta property="og:url" content=""/>
    <meta property="og:site_name" content=""/>
    <meta property="og:description" content=""/>
    <meta name="twitter:title" content="" />
    <meta name="twitter:image" content="" />
    <meta name="twitter:url" content="" />
    <meta name="twitter:card" content="" />

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700" rel="stylesheet">

    <!-- Animate.css -->
    <link rel="stylesheet" href="css/animate.css">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="css/icomoon.css">
    <!-- Themify Icons-->
    <link rel="stylesheet" href="css/themify-icons.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="admin/vendors/bootstrap/dist/css/bootstrap.min.css">


    <!-- Magnific Popup -->
    <link rel="stylesheet" href="css/magnific-popup.css">

    <!-- Owl Carousel  -->
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">

   
        <!-- Custom Theme Style -->
    <link rel="stylesheet" href="admin/build/css/custom.min.css">

        <!-- Theme style  -->
    <link rel="stylesheet" href="css/style.css">


    <link href="admin/vendors/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
    <link href="admin/vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css" rel="stylesheet">

    <!-- Modernizr JS -->
    <script src="js/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.12.1/firebase-firestore.js"></script>

    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyC4RrZ1ZAvMGLaDhGCB1TCfm4WzgdZT1cI",
            authDomain: "csc-4330.firebaseapp.com",
            databaseURL: "https://csc-4330.firebaseio.com",
            projectId: "csc-4330",
            storageBucket: "csc-4330.appspot.com",
            messagingSenderId: "549352708672"
        };
        firebase.initializeApp(config);
    </script>
    <style>
        .form-control{
            height: auto !important;
            font-size: unset !important;
        }
        @media (min-width: 768px)
            .col-sm-6 {
            width: 45% !important;
        }
    </style>

</head>
<body>

<div class="gtco-loader"></div>

<div id="page">


    <div class="page-inner">
        <nav class="gtco-nav" role="navigation">
            <div class="gtco-container">

                <div class="row">
                    <div class="col-sm-4 col-xs-12">
                        <div id="gtco-logo"><a href="index.html">MODEL <em>.</em></a></div>
                    </div>
                </div>

            </div>
        </nav>
        <header id="gtco-header" class="gtco-cover" role="banner" style="background-image: url(images/img_4.jpg)">
            <div class="overlay"></div>
            <div class="gtco-container">
                <div class="row">
                    <div class="col-md-12 col-md-offset-0 text-left">


                        <div class="row row-mt-5em">
                            <div class="col-md-7 mt-text animate-box" data-animate-effect="fadeInUp">
                                <span class="intro-text-small">Technician</span>
                                <!--<h1>Your problem is our solution.<br><br>Sign up today!</h1>-->
                            </div>
                            <div class="col-md-10 col-md-push-1 animate-box" data-animate-effect="fadeInRight">
                                <div class="form-wrap">
                                    <div class="tab">
                                        <ul class="tab-menu">
                                            <li class="active gtco-first"><a href="#" data-tab="queue">View Queue</a></li>
                                            <li class="gtco-second"><a href="#" data-tab="bill">Generate Bill</a></li>
                                        </ul>
                                        <div class="tab-content">
                                            <div class="tab-content-inner active" data-content="queue">
                                                <form name="signupform" action=""  method="post">
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <div class="x_panel">
                                                            <div class="x_title">
                                                                <div class="clearfix"></div>
                                                            </div>
                                                            <div class="x_content">
                                                                <div class="row">
                                                                    <div class="col-sm-12">
                                                                        <div class="card-box table-responsive">

                                                                            <table id="datatable-tech" class="table table-striped jambo_table bulk_action table-bordered ">
                                                                                <thead>
                                                                                <tr>
                                                                                    <th>Emergency</th>
                                                                                <th>First Name</th>
                                                                                <th>Email</th>
                                                                                <th>Subject</th>
                                                                                <th>Message</th>
                                                                                <th>Total Request</th>
                                                                                <th>Difficulty</th>
                                                                                <th>Request Time</th>
                                                                                </tr>
                                                                                </thead>
                                                                            </table>

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row form-group">
                                                        <div class="col-md-12">
                                                            <button  class="btn btn-primary" type="button" id="take_request">Take Request</button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>

                                            <div class="tab-content-inner" data-content="bill">
                                                <form action="#" >
                                                    <div class="row form-group">
                                                        <div class="col-md-12">
                                                            <label id="customerName" class="sr-only" for="name">Name</label>
                                                            <script>
                                                                //var name = document.getElementById("customerName").value;
                                                                localStorage.setItem("name", document.getElementById("customerName").value);
                                                            </script>
                                                            <input type="text" id="name" class="form-control" placeholder="Customer's First Name">
                                                        </div>
                                                    </div>
                                                    <div class="row form-group">
                                                        <div class="col-md-12">
                                                            <label class="sr-only" for="hours">Hours Required</label>
                                                            <input type="number" id="hours" class="form-control" placeholder="Number of hours required">
                                                        </div>
                                                    </div>
                                                    <div class="row form-group">
                                                        <div class="col-md-12">

                                                            <select name="mydropdown" class="form-control">
                                                                <option value="John Doe">John Doe</option>
                                                                <option value="Jane Doe">Jane Doe</option>
                                                                <option value="Tim Smith">Tim Smith</option>
                                                            </select>
                                                            <p style="color: red" id="request_confirmation1"></p>
                                                        </div>

                                                    </div>
                                                    <div class="form-group">
                                                        <!--<form name="billForm" action="bill.html">-->
                                                            <button  onclick="generateBill()" type="button" value="Generate" class="btn btn-primary">Generate
                                                                <script>
                                                                    function generateBill(){
                                                                        var name = document.getElementById("customerName").value;
                                                                        var hours = document.getElementById("hours").value;
                                                                        var requestConfirm = document.getElementById("request_confirmation1").value;

                                                                        if (name === "")
                                                                            requestConfirm.innerHTML = "Please enter your name.";
                                                                        else if (hours === "")
                                                                            requestConfirm.innerHTML = "Please enter the number of hours required.";
                                                                        window.location.href= "bill.html"
                                                                    }
                                                                </script>
                                                            </button>
                                                        <!--<input type="submit" value="Generate" class="btn btn-primary">-->
                                                    </div>

                                                </form>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>

        </header>
        <footer id="gtco-footer" role="contentinfo">
                    <div class="gtco-container">
                        <div class="row row-p   b-md">

                            <div class="col-md-4">
                                <div class="gtco-widget">
                                    <h3>About <span class="footer-logo">MODEL<span>.<span></span></span></span></h3>
                                    <p>MODEL Computing Services has provided this web-based system to give customers the ability to create requests in order get assistance in technical work. </p>
                                </div>
                            </div>

                           
                        <div class="col-md-4 col-md-push-1">
                            <div class="gtco-widget">
                                <h3>Links</h3>
                                <ul class="gtco-footer-links">
                                    <li><a href="index.html">Home Page</a></li>
                                    <li><a href="admin/production/adminLogin.html">Admin Access</a></li>
                                    <li><a href="admin/production/technicianLogin.html">Technician Access</a></li>
                                </ul>
                            </div>
                        </div>

                            <div class="col-md-4">
                                <div class="gtco-widget">
                                  
                                </div>
                            </div>

                        </div>

                        <div class="row copyright">
                            <div class="col-md-12">
                                <p class="pull-left">
                                    <small class="block">&copy; 2016 Free HTML5. All Rights Reserved.</small>
                                  <small class="block"> Demo Images: <a href="http://unsplash.co/" target="_blank">Unsplash</a></small>
                                </p>
                                
                            </div>
                        </div>

                    </div>
        </footer>
       
    </div>

</div>
 
<div class="gototop js-top">
    <a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
</div>

<!-- jQuery -->
<script src="js/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="js/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="js/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="js/jquery.waypoints.min.js"></script>
<!-- Carousel -->
<script src="js/owl.carousel.min.js"></script>
<!-- countTo -->
<script src="js/jquery.countTo.js"></script>
<!-- Magnific Popup -->
<script src="js/jquery.magnific-popup.min.js"></script>
<script src="js/magnific-popup-options.js"></script>
<!-- Main -->
<script src="js/main.js"></script>
<!-- Queue -->
<script src="js/queue.js"></script>
<script src="admin/vendors/datatables.net/js/jquery.dataTables.min.js"></script>
<!--<script src="admin/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>-->
<!--<script src="admin/vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>-->
<!--<script src="admin/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>-->
<script src="admin/vendors/datatables.net-keytable/js/dataTables.keyTable.min.js"></script>
<!--<script src="admin/vendors/datatables.net-scroller/js/dataTables.scroller.min.js"></script>-->
<script src="admin/build/js/custom.min.js"></script>
<script src="https://cdn.datatables.net/select/1.2.5/js/dataTables.select.min.js"></script>
<script>
    var db = firebase.firestore();
    var data = [];
    db.collection("queue").get().then(function(querySnapshot) {
        querySnapshot.forEach(function(doc) {
            // doc.data() is never undefined for query doc snapshots
            console.log(doc.data());
            //batch Write Script
            // var idDoc = doc.data().first + "-" + doc.data().email;
            // var docRef = db.collection("queue").doc(idDoc);
            // docRef.set({
            //     first: doc.data().first,
            //     email: doc.data().email,
            //     subject: doc.data().subject,
            //     message: doc.data().message,
            //     count: doc.data().count,
            //     difficulty: doc.data().difficulty,
            //     time: doc.data().time
            // });
            data.push(doc.data());
        });
        console.log(data);
        var table = $('#datatable-tech').DataTable( {
            //stateSave: true,
            key: true,
            //"order":[4,'desc'],
            data: data,
            columns: [
                {data: "priority",
                    "defaultContent":""},
                { data: "first" },
                { data: "email" },
                { data: "subject" },
                { data: "message" },
                { data: "count",
                },
                { data: "difficulty",
                    "defaultContent": "",
                },
                { data: "time",
                    "defaultContent": "",
                }
            ]
        } );
        table.column(0).visible(false);
        table.order([0,"desc"], [4,"desc"], [5,"asc"],[6, "asc"]).draw();

        $('#take_request').click(function () {
            var removeData = table.row(':eq(0)', { page: 'current' }).data();
            var currentTime = Date.now();
            db.collection('work_hour').doc(removeData.first+"-"+removeData.email).set({
                work_hours: (currentTime - Date.parse(removeData.time)) / 3600000.0
            });
            db.collection('queue').doc(removeData.first+"-"+removeData.email).delete().then(function () {
                console.log("success");
            }).catch(function (error) {
                console.log(error);
            });

            table.row(':eq(0)', { page: 'current' }).select().remove().draw( false );
        })

    });
    // db.collection("users").get().then(function(querySnapshot) {
    //     querySnapshot.forEach(function (doc) {
    //         // doc.data() is never undefined for query doc snapshots
    //
    //         //countData.push(counter(data, doc.id));
    //
    //     });
    //     console.log(counter(data, "Jun@gmail.com"));
    //
    // });


    // db.collection("users").get().then(function(querySnapshot) {
    //     querySnapshot.forEach(function(doc) {
    //         // doc.data() is never undefined for query doc snapshots
    //         data = doc.data();
    //         console.log(doc.id, " => ", doc.data());
    //     });
    // });


</script>


</body>
</html>
